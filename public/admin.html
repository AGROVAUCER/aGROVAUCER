
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>AGROV ADMIN PANEL</title>
</head>
<body>
  <h1>AGROV ADMIN PANEL</h1>

  <button onclick="loadUsers()">Load users</button>
  <pre id="output"></pre>

  <script>
    const API = "http://localhost:8080/api";
    let TOKEN = null;

    async function login() {
      const r1 = await fetch(API + "/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone: "061000000" })
      });
      const d1 = await r1.json();

      const r2 = await fetch(API + "/unlock", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ userId: d1.userId, pin: "1234" })
      });
      const d2 = await r2.json();

      TOKEN = d2.token;
    }

    async function loadUsers() {
      if (!TOKEN) {
        await login();
      }

      const r = await fetch(API + "/admin/users", {
        headers: {
          Authorization: "Bearer " + TOKEN
        }
      });

      const data = await r.json();
      document.getElementById("output").textContent =
        JSON.stringify(data, null, 2);
    }
  </script>
</body>
</html>
